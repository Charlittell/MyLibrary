(function(e){function t(t){for(var r,i,n=t[0],l=t[1],c=t[2],u=0,p=[];u<n.length;u++)i=n[u],a[i]&&p.push(a[i][0]),a[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);d&&d(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),o()}function o(){for(var e,t=0;t<s.length;t++){for(var o=s[t],r=!0,i=1;i<o.length;i++){var l=o[i];0!==a[l]&&(r=!1)}r&&(s.splice(t--,1),e=n(n.s=o[0]))}return e}var r={},a={app:0},s=[];function i(e){return n.p+"js/"+({about:"about"}[e]||e)+"."+{about:"65c0bc2e"}[e]+".js"}function n(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.e=function(e){var t=[],o=a[e];if(0!==o)if(o)t.push(o[2]);else{var r=new Promise(function(t,r){o=a[e]=[t,r]});t.push(o[2]=r);var s,l=document.createElement("script");l.charset="utf-8",l.timeout=120,n.nc&&l.setAttribute("nonce",n.nc),l.src=i(e),s=function(t){l.onerror=l.onload=null,clearTimeout(c);var o=a[e];if(0!==o){if(o){var r=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src,i=new Error("Loading chunk "+e+" failed.\n("+r+": "+s+")");i.type=r,i.request=s,o[1](i)}a[e]=void 0}};var c=setTimeout(function(){s({type:"timeout",target:l})},12e4);l.onerror=l.onload=s,document.head.appendChild(l)}return Promise.all(t)},n.m=e,n.c=r,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var d=c;s.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"034f":function(e,t,o){"use strict";var r=o("64a9"),a=o.n(r);a.a},"0527":function(e,t,o){},"1a8b":function(e,t,o){},"1c67":function(e,t,o){},"2cde":function(e,t,o){},"305c":function(e,t,o){"use strict";var r=o("1c67"),a=o.n(r);a.a},3923:function(e,t,o){"use strict";var r=o("5aa7"),a=o.n(r);a.a},"3a23":function(e,t,o){"use strict";var r=o("48c7"),a=o.n(r);a.a},"3b67":function(e,t,o){"use strict";var r=o("ba6d"),a=o.n(r);a.a},"3fc3":function(e,t,o){},"48c7":function(e,t,o){},"4b6c":function(e,t,o){},"54f8":function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);var r=o("2b0e"),a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("mynavbar"),e.isRouterAlive?o("router-view"):e._e()],1)},s=[],i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"mynavbar"},[o("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"info"}},[o("b-navbar-brand",{on:{click:e.gotohome}},[e._v("东华图书馆")]),o("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),o("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[e.isAdmin?o("b-navbar-nav",[o("b-nav-item-dropdown",{attrs:{text:"图书管理",left:""}},[o("b-dropdown-item",{on:{click:e.gotoaddbook}},[e._v("添加图书")]),o("b-dropdown-item",{on:{click:e.gotomanager}},[e._v("修改图书")]),o("b-dropdown-item",{on:{click:e.gototypemanager}},[e._v("类型管理")])],1),o("b-nav-item-dropdown",{attrs:{text:"用户管理",left:""}},[o("b-dropdown-item",{on:{click:e.gotoborrowmanage}},[e._v("借阅管理")]),o("b-dropdown-item",{on:{click:e.gotoreadermanage}},[e._v("权限管理")])],1)],1):o("b-navbar-nav",[o("b-nav-item",{on:{click:e.gotomanager}},[e._v("查找所有图书")])],1),e.isLogin?o("b-navbar-nav",{staticClass:"ml-auto"},[o("b-nav-item-dropdown",{attrs:{right:""}},[o("template",{slot:"button-content"},[o("em",[e._v(e._s(e.userName))])]),o("b-dropdown-item",{on:{click:e.showreaderinfo}},[e._v("个人信息管理")]),o("b-dropdown-item",{on:{click:e.gotomyborrow}},[e._v("我的借阅")]),o("b-dropdown-item",{on:{click:e.gotomyfavor}},[e._v("我的收藏")]),o("b-dropdown-item",{on:{click:e.gotouserinfo}},[e._v("修改密码")])],2),o("b-nav-item",{on:{click:e.logout}},[e._v("退出登录")])],1):o("b-navbar-nav",{staticClass:"ml-auto"},[o("b-nav-item",{on:{click:e.showLoginModal}},[e._v("登录")]),o("b-nav-item",{on:{click:e.showRegisterModal}},[e._v("注册")])],1)],1)],1),o("b-modal",{ref:"loginmodal",attrs:{id:"login",title:"用户登录"},on:{show:e.resetModal,hidden:e.resetModal,ok:e.handleOk}},[o("form",{ref:"loginform",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.login(t)}}},[o("b-form-group",{attrs:{state:e.nameState,label:"学号","label-for":"stuno","invalid-feedback":"请输入九位学号"}},[o("b-form-input",{ref:"stunotext",attrs:{id:"stuno",state:e.nameState,required:""},model:{value:e.stuno,callback:function(t){e.stuno=t},expression:"stuno"}})],1),o("b-form-group",{attrs:{state:e.passwordstate,label:"密码","label-for":"password","invalid-feedback":"请输入密码"}},[o("b-form-input",{attrs:{id:"password",type:"password",state:e.passwordstate,required:""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1)]),o("b-modal",{ref:"registermodal",attrs:{id:"register",title:"用户注册"},on:{show:e.resetModal,hidden:e.resetModal,ok:e.handleregisterOk}},[o("form",{ref:"registerform",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.register(t)}}},[o("b-form-group",{attrs:{state:e.registernameState,label:"学号","label-for":"stuno","invalid-feedback":"请输入九位学号"}},[o("b-form-input",{ref:"registerstunotext",attrs:{id:"registerstuno",state:e.registernameState,required:""},model:{value:e.registerstuno,callback:function(t){e.registerstuno=t},expression:"registerstuno"}})],1),o("b-form-group",{attrs:{state:e.registerpasswordstate,label:"密码","label-for":"registerpassword","invalid-feedback":"请输入密码"}},[o("b-form-input",{attrs:{id:"registerpassword",type:"password",state:e.registerpasswordstate,required:""},model:{value:e.registerpassword,callback:function(t){e.registerpassword=t},expression:"registerpassword"}})],1),o("b-form-group",{attrs:{state:e.reregisterpasswordstate,label:"确认密码","label-for":"reregisterpassword","invalid-feedback":"两次密码不一致"}},[o("b-form-input",{attrs:{id:"reregisterpassword",type:"password",state:e.reregisterpasswordstate,required:""},model:{value:e.reregisterpassword,callback:function(t){e.reregisterpassword=t},expression:"reregisterpassword"}})],1)],1)])],1)},n=[],l=o("4328"),c=o.n(l),u={inject:["reload"],name:"mynavbar",data:function(){return{userName:"",isLogin:!1,stuno:"",nameState:null,password:"",passwordstate:null,registerstuno:"",registernameState:null,registerpassword:"",registerpasswordstate:null,reregisterpassword:"",reregisterpasswordstate:null,isAdmin:!1}},mounted:function(){if(console.log(sessionStorage.getItem("user")),null!=sessionStorage.getItem("user")){var e=sessionStorage.getItem("user"),t=JSON.parse(e);this.isLogin=!0,this.userName=t.userName,99==t.authority&&(this.isAdmin=!0)}},methods:{gototypemanager:function(){this.$router.push("/typemanage")},gotoreadermanage:function(){this.$router.push("/readermanage")},gotoborrowmanage:function(){this.$router.push("/borrowmanage")},gotouserinfo:function(){this.$router.push("/userinfo")},gotoaddbook:function(){this.$router.push("/addbook")},gotomyfavor:function(){this.$router.push("/myfavor")},gotomyborrow:function(){this.$router.push("/myborrow")},gotomanager:function(){this.$router.push("/manager")},showreaderinfo:function(){this.$router.push("/readerinfo")},gotohome:function(){this.$router.push("/")},showLoginModal:function(){this.$refs["loginmodal"].show()},showRegisterModal:function(){this.$refs["registermodal"].show()},checkRegisterFormValidity:function(){var e=!0;return""==this.registerstuno||9!=this.registerstuno.length?(this.registernameState="invalid",e=!1):this.registernameState="valid",""==this.registerpassword?(this.registerpasswordstate="invalid",e=!1):this.registerpasswordstate="valid",""==this.reregisterpassword||this.reregisterpassword!=this.registerpassword?(this.reregisterpasswordstate="invalid",e=!1):this.reregisterpasswordstate="valid",console.log(e),e},checkLoginFormValidity:function(){var e=!0;return""==this.stuno||9!=this.stuno.length?(this.nameState="invalid",e=!1):this.nameState="valid",""==this.password?(this.passwordstate="invalid",e=!1):this.passwordstate="valid",console.log(e),e},resetModal:function(){this.stuno="",this.password="",this.nameState=null,this.passwordstate=null,this.registerstuno="",this.registerpassword="",this.registernameState=null,this.registerpasswordstate=null,this.reregisterpassword="",this.reregisterpasswordstate=null},handleOk:function(e){e.preventDefault(),this.handleSubmit()},handleregisterOk:function(e){e.preventDefault(),this.handleregisterSubmit()},handleregisterSubmit:function(){var e=this;this.checkRegisterFormValidity()&&(this.axios.post("/user/signup",c.a.stringify({userName:this.registerstuno,password:this.registerpassword})).then(function(t){if(console.dir(t.data),null==t.data)return e.$message.error("注册失败，用户名已存在"),!1;e.$message.success("注册成功")}).catch(function(e){console.log(e)}),this.$nextTick(function(){e.$refs.registermodal.hide()}))},logout:function(){var e=this;this.$confirm("确认退出？").then(function(t){sessionStorage.removeItem("user"),e.$message.success("退出成功"),e.isLogin=!1,e.isAdmin=!1,e.$router.push("/")}).catch(function(e){})},handleSubmit:function(){var e=this;if(this.checkLoginFormValidity()){var t={stuno:this.stuno,password:this.password};this.axios.post("/user/login",c.a.stringify(t)).then(function(t){if(console.dir(t.data),!t.data)return e.$message.error("登录失败"),!1;sessionStorage.setItem("user",JSON.stringify(t.data)),e.$message.success("登陆成功"),e.reload(),e.userName=t.data.userName,e.isLogin=!0,99==t.data.authority&&(e.isAdmin=!0)}).catch(function(e){console.log(e)}),this.$nextTick(function(){e.$refs.loginmodal.hide()})}}}},d=u,p=(o("9589"),o("2877")),m=Object(p["a"])(d,i,n,!1,null,"003e3ba0",null),b=m.exports,h={components:{mynavbar:b},provide:function(){return{reload:this.reload}},data:function(){return{isRouterAlive:!0}},methods:{reload:function(){this.isRouterAlive=!1,this.$nextTick(function(){this.isRouterAlive=!0})}}},g=h,f=(o("034f"),Object(p["a"])(g,a,s,!1,null,null,null)),v=f.exports,k=o("8c4f"),w=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"home"},[o("b-container",[o("b-carousel",{staticStyle:{"text-shadow":"1px 1px 2px #333"},attrs:{id:"carousel-1",interval:4e3,controls:"",indicators:"",background:"#ababab","img-width":"400","img-height":"120"},on:{"sliding-start":e.onSlideStart,"sliding-end":e.onSlideEnd},model:{value:e.slide,callback:function(t){e.slide=t},expression:"slide"}},[o("b-carousel-slide",{attrs:{"img-src":"https://picsum.photos/1024/480/?image=58"}}),o("b-carousel-slide",{attrs:{"img-src":"https://picsum.photos/1024/480/?image=58"}}),o("b-carousel-slide",{attrs:{"img-src":"https://picsum.photos/1024/480/?image=58"}})],1),o("b-row",[o("b-col",{attrs:{md:"6"}},[o("b-card",{attrs:{"border-variant":"secondary",header:"科幻","header-border-variant":"secondary",align:"center"}},[o("b-card-text",[e._v("科幻书")])],1)],1),o("b-col",{attrs:{md:"6"}},[o("b-card",{attrs:{"border-variant":"secondary",header:"教育","header-border-variant":"secondary",align:"center"}},[o("b-card-text",[e._v("Lorem ipsum dolor sit amet, consectetur adipiscing elit.")])],1)],1)],1),o("b-row",[o("b-col",{attrs:{md:"6"}},[o("b-card",{attrs:{"border-variant":"secondary",header:"悬疑","header-border-variant":"secondary",align:"center"}},[o("b-list-group-item",{attrs:{disabled:""}},[e._v("book")]),o("b-list-group-item",[e._v("book")]),o("b-list-group-item",[e._v("book")]),o("b-list-group-item",{attrs:{disabled:""}},[e._v("book")]),o("b-list-group-item",[e._v("book")])],1)],1),o("b-col",{attrs:{md:"6"}},[o("b-card",{attrs:{"border-variant":"secondary",header:"长篇小说","header-border-variant":"secondary",align:"center"}},[o("b-list-group-item",{attrs:{disabled:""}},[e._v("book")]),o("b-list-group-item",[e._v("book")]),o("b-list-group-item",[e._v("book")]),o("b-list-group-item",{attrs:{disabled:""}},[e._v("book")]),o("b-list-group-item",[e._v("book")])],1)],1)],1)],1)],1)},y=[],L={name:"home",data:function(){return{loginShow:!1,signupShow:!1,isLogin:!1,user:{userName:"",password:""},VerificationImg:"",nameState:null,slide:0,sliding:null}},computed:{},methods:{checkFormValidity:function(){var e=!1;return this.nameState=e?"valid":"invalid",e},resetModal:function(){this.user.userName="",this.user.password="",this.nameState=null},handleOk:function(e){e.preventDefault(),this.handleSubmit()},handleSubmit:function(){var e=this;console.log(this.nameState),this.checkFormValidity()&&this.$nextTick(function(){e.$refs["login"].hide()})},clickVerification:function(){var e=Math.random();this.imgUrls(e)},imgUrls:function(e){this.VerificationImg="src/assets/logo.png"},onSlideStart:function(e){this.sliding=!0},onSlideEnd:function(e){this.sliding=!1}}},$=L,x=(o("73ba"),Object(p["a"])($,w,y,!1,null,"37821ae6",null)),S=x.exports,_=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login",staticStyle:{width:"30%",margin:"auto",background:"white",padding:"40px"}})},R=[],N={name:"login",data:function(){return{form:{userName:"",password:""},show:!0}}},I=N,z=Object(p["a"])(I,_,R,!1,null,null,null),E=z.exports,C=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"detail"},[o("b-container",[o("b-card-group",{attrs:{deck:""}},[o("b-card",{staticStyle:{"max-width":"30rem",margin:"auto"},attrs:{"no-body":"","img-src":"https://placekitten.com/380/200","img-alt":"Image","img-top":""}},[o("h4",{attrs:{slot:"header"},slot:"header"},[e._v("借书卡")]),o("b-card-body",[o("b-card-title",{domProps:{textContent:e._s(this.bookList.bookName)}}),o("b-card-text",[e._v("\n        Some quick example text to build on the card title and make up the bulk of the card's\n        content.\n      ")])],1),o("b-list-group",{attrs:{flush:""}},[o("b-list-group-item",{domProps:{textContent:e._s("作者："+this.bookList.author)}}),o("b-list-group-item",{domProps:{textContent:e._s("出版社："+this.bookList.publisher)}}),o("b-list-group-item",{domProps:{textContent:e._s("出借次数："+this.bookList.borrowCount)}}),o("b-list-group-item",{domProps:{textContent:e._s("库存："+this.bookList.stockNumber)}})],1),o("b-card-body",[o("b-button",{staticStyle:{margin:"20"},attrs:{variant:"primary"},on:{click:e.borrow}},[e._v("我要借书")]),e.isfavored?o("b-button",{attrs:{variant:"success"},on:{click:e.removefavor}},[e._v("取消收藏")]):o("b-button",{attrs:{variant:"success"},on:{click:e.addfavor}},[e._v("添加到收藏")])],1)],1)],1)],1)],1)},O=[],P={inject:["reload"],mounted:function(){var e=this;if(this.axios.post("book/selectBookById",c.a.stringify({bookId:this.$route.query.info})).then(function(t){t.data?(console.log(t.data),e.bookList=t.data):e.$message.error("未找到结果")}).catch(function(t){e.$message.error("".concat(t.message),"ERROR!")}),null!=sessionStorage.getItem("user")){var t=sessionStorage.getItem("user"),o=JSON.parse(t);this.axios.post("favor/query",c.a.stringify({bookId:this.$route.query.info,readerId:o.userId})).then(function(t){console.log(t.data),t.data?(e.isfavored=!0,e.favor=t.data):e.isfavored=!1}).catch(function(t){e.$message.error("".concat(t.message),"ERROR!")})}else this.isfavored=!1},data:function(){return{bookList:[],isfavored:!1,favor:{}}},methods:{removefavor:function(){var e=this;this.axios.post("/favor/removefavor",c.a.stringify({favorId:this.favor.favorId})).then(function(t){console.log(t.data),1==t.data?(e.$message.success("取消收藏成功"),e.reload()):e.$message.error("error","ERROR!")}).catch(function(t){e.$message.error("".concat(t.message),"ERROR!")})},addfavor:function(){var e=this;if(null!=sessionStorage.getItem("user")){var t=sessionStorage.getItem("user"),o=JSON.parse(t);this.axios.post("/favor/addfavor",c.a.stringify({readerId:o.userId,bookId:this.bookList.bookId})).then(function(t){console.log(t.data),1==t.data?(e.$message.success("添加成功"),e.reload()):e.$message.error("添加失败","ERROR!")}).catch(function(t){e.$message.error("".concat(t.message),"ERROR!")})}else this.$message.error("请先登录","ERROR!")},borrow:function(){var e=this;if(null!=sessionStorage.getItem("user"))if(0!=this.bookList.stockNumber){var t=sessionStorage.getItem("user"),o=JSON.parse(t);this.axios.post("/borrow/borrowBook",c.a.stringify({readerId:o.userId,bookId:this.bookList.bookId})).then(function(t){console.log(t.data),0==t.data?(e.$message.success("借书成功"),e.reload()):e.$message.error("借书数量达到上限","ERROR!")}).catch(function(t){e.$message.error("".concat(t.message),"ERROR!")})}else this.$message.error("库存不足","ERROR!");else this.$message.error("请先登录","ERROR!")}}},B=P,j=Object(p["a"])(B,C,O,!1,null,"3630322c",null),U=j.exports,A=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"content"},[o("b-container",{staticStyle:{background:"white","margin-top":"60px",height:"300px",padding:"20px"}},[o("b-row",{staticClass:"row top-buffer"},[o("b-col",{attrs:{md:"12"}},[o("h3",[e._v("title")])])],1),o("b-row",{staticClass:"row top-buffer"},[o("b-col",{attrs:{md:"1"}},[o("b-img",e._b({attrs:{rounded:"circle",alt:"Circle image"}},"b-img",e.subProps,!1))],1),o("b-col",{attrs:{md:"1"}},[o("span",[e._v("发帖时间")]),o("span",[e._v("用户名")])]),o("b-col",{attrs:{md:"1"}},[o("b-badge",{attrs:{variant:"success"}},[e._v("精华")]),o("b-badge",{attrs:{variant:"danger"}},[e._v("置顶")])],1),o("b-col",{attrs:{md:"1",left:""}},[o("p",[e._v("添加到收藏")])])],1),o("hr"),o("b-row",[o("b-col",{attrs:{md:"12"}},[o("span",[e._v("\n                  这里是回复内容\n                ")])])],1)],1),o("b-container",{staticStyle:{background:"white","margin-top":"20px",height:"500px",padding:"20px"}},[o("b-row",{staticClass:"row top-buffer"},[o("b-col",{attrs:{md:"1"}},[o("b-img",e._b({attrs:{rounded:"circle",alt:"Circle image"}},"b-img",e.subProps,!1))],1),o("b-col",{attrs:{md:"1"}},[o("span",[e._v("发帖时间")])]),o("b-col",{attrs:{md:"1"}},[o("span",[e._v("用户名")])])],1),o("b-row",[o("b-col",[o("div",{staticStyle:{left:"20px"}},[e._v("neirongneirongng")])])],1),o("hr"),o("b-row",{staticClass:"row top-buffer"},[o("b-col",{attrs:{md:"1"}},[o("b-img",e._b({attrs:{rounded:"circle",alt:"Circle image"}},"b-img",e.subProps,!1))],1),o("b-col",{attrs:{md:"1"}},[o("span",[e._v("发帖时间")])]),o("b-col",{attrs:{md:"1"}},[o("span",[e._v("用户名")])])],1),o("b-row",[o("b-col",{attrs:{md:"1","offset-md":"1",s:""}},[o("div",{staticStyle:{}},[e._v("s")])])],1),o("hr"),o("b-row",{staticClass:"row top-buffer"},[o("b-col",{attrs:{md:"1"}},[o("b-img",e._b({attrs:{rounded:"circle",alt:"Circle image"}},"b-img",e.subProps,!1))],1),o("b-col",{attrs:{md:"1"}},[o("span",[e._v("发帖时间")])]),o("b-col",{attrs:{md:"1"}},[o("span",[e._v("用户名")])])],1),o("b-row",[o("b-col",[e._v("\n            \n                 neirongneirongng\n            ")])],1),o("hr")],1)],1)},M=[],V={data:function(){return{mainProps:{blank:!0,blankColor:"#777",width:75,height:75,class:"m1"},subProps:{blank:!0,blankColor:"#777",width:45,height:45,class:"m1"}}}},J=V,q=(o("92e6"),Object(p["a"])(J,A,M,!1,null,"b4fdf1f2",null)),D=q.exports,T=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"bookmanage",staticStyle:{margin:"auto"}},[o("b-container",[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:6}},[o("el-select",{attrs:{clearable:"",placeholder:"请选择搜索类型"},model:{value:e.condition,callback:function(t){e.condition=t},expression:"condition"}},[o("el-option",{attrs:{label:"作者",value:"作者"}}),o("el-option",{attrs:{label:"书名",value:"书名"}}),o("el-option",{attrs:{label:"出版社",value:"出版社"}}),o("el-option",{attrs:{label:"编号",value:"编号"}}),o("el-option",{attrs:{label:"类型",value:"类型"}})],1)],1),o("el-col",{attrs:{span:6}},[o("el-input",{attrs:{placeholder:"请输入搜索内容","prefix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),o("el-col",{attrs:{span:2}},[o("el-button",{attrs:{type:"primary",round:"",size:"medium"},on:{click:e.applysearch}},[e._v("搜索")])],1),o("el-col",{attrs:{span:2}},[o("el-button",{attrs:{type:"primary",round:"",size:"medium"},on:{click:e.reset}},[e._v("清空搜索")])],1)],1),o("el-table",{staticStyle:{width:"100%",height:"800"},attrs:{data:this.pagedata.records,"max-height":"800"},on:{"row-click":e.op}},[o("el-table-column",{attrs:{label:"封面",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return[o("img",{staticClass:"head_pic",attrs:{src:"http://47.103.36.216:8085/bookimg/"+e.row.picture,width:"40",height:"40"}})]}}])}),o("el-table-column",{attrs:{prop:"bookName",label:"书名",width:"180"}}),o("el-table-column",{attrs:{prop:"ISBN",label:"ISBN",width:"160"}}),o("el-table-column",{attrs:{prop:"typeName",label:"类型",width:"100"}}),o("el-table-column",{attrs:{prop:"author",label:"作者",width:"100"}}),o("el-table-column",{attrs:{prop:"publisher",label:"出版社",width:"180"}}),o("el-table-column",{attrs:{prop:"shelter",label:"书架",width:"180"}}),e.isAdmin?o("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button-group",[o("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(o){return e.modify(t.row)}}},[e._v("修改")])],1)]}}],null,!1,2034634281)}):e._e()],1),o("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagedata.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},F=[],G={data:function(){return{currentPage:1,pagesize:10,pagedata:{records:[],total:0,size:0,current:0,searchCount:!0,pages:0},bookList:[],search:"",postBook:{bookId:"",bookName:"",ISBN:"",typeName:"",author:"",publisher:""},condition:"",onSearch:!1,isAdmin:!1}},created:function(){if(this.handleBookList(),null!=sessionStorage.getItem("user")){var e=sessionStorage.getItem("user"),t=JSON.parse(e);99==t.authority&&(this.isAdmin=!0)}},methods:{op:function(e){this.$router.push({name:"detail",query:{info:e.bookId}})},handleSizeChange:function(e){this.pagesize=e,console.log(this.pagesize),this.onSearch?this.applysearch():this.handleBookList()},handleCurrentChange:function(e){this.currentPage=e,console.log(this.currentPage),this.onSearch?this.applysearch():this.handleBookList()},handleBookList:function(){var e=this;this.axios.post("/book/bookpage",c.a.stringify({cu:this.currentPage,size:this.pagesize})).then(function(t){return e.pagedata=t.data,console.log(e.pagedata)})},dele:function(e,t){var o=this;this.$confirm("确认删除？").then(function(r){o.axios.post("SpringMVC/api/deletebook",e).then(function(t){t.data&&(t.data.success?(o.bookList.slice(e.index),o.$message.success("删除成功")):o.$message.error("删除失败"))}).catch(function(e){o.$message.error("".concat(e.message),"ERROR!")}),console.log(t),o.bookList.splice(t,1)}).catch(function(e){})},applysearch:function(){var e=this;if(""!=this.search&&""!=this.condition){var t={bookId:null,bookName:null,typeName:null,author:null,publisher:null};switch(this.condition){case"书名":t.bookName=this.search;break;case"作者":t.author=this.search;break;case"编号":t.bookId=this.search;break;case"类型":t.typeName=this.search;break;case"出版社":t.publisher=this.search;break;default:}this.onSearchonSearch||(this.onSearchonSearch=!0,this.currentPage=1);var o={book:t,cu:this.currentPage,size:this.pagesize};this.axios.post("book/searchBook",o).then(function(t){e.bookList=t.data,t.data&&(console.log(t.data),t.data?e.pagedata=t.data:e.$message.error("未找到结果"))}).catch(function(t){e.$message.error("".concat(t.message),"ERROR!")})}else this.$message.error("搜索条件不能为空")},addbook:function(){this.$router.push("/bookchange")},reset:function(){this.onSearch=!1,this.currentPage=1,this.handleBookList(),this.search="",this.condition=""},modify:function(e){this.$router.push({name:"modifybook",params:{info:e}})}}},H=G,K=(o("ff0f"),Object(p["a"])(H,T,F,!1,null,"6f7e288a",null)),Q=K.exports,W=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"readerinfo"},[o("el-form",{ref:"readerList",attrs:{rules:e.addRules,model:e.readerList,"label-width":"80px",size:"small"}},[o("el-form-item",{attrs:{label:"用户编号",prop:"readerId"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.readerList.readerId,callback:function(t){e.$set(e.readerList,"readerId",t)},expression:"readerList.readerId"}})],1),o("el-form-item",{attrs:{label:"真实姓名",prop:"realName"}},[o("el-input",{model:{value:e.readerList.realName,callback:function(t){e.$set(e.readerList,"realName",t)},expression:"readerList.realName"}})],1),o("el-form-item",{attrs:{label:"年龄",prop:"age"}},[o("el-input",{model:{value:e.readerList.age,callback:function(t){e.$set(e.readerList,"age",t)},expression:"readerList.age"}})],1),o("el-form-item",{attrs:{label:"性别",prop:"sex"}},[o("el-radio",{attrs:{label:"男","aria-checked":""},model:{value:e.readerList.sex,callback:function(t){e.$set(e.readerList,"sex",t)},expression:"readerList.sex"}},[e._v("男")]),o("el-radio",{attrs:{label:"女"},model:{value:e.readerList.sex,callback:function(t){e.$set(e.readerList,"sex",t)},expression:"readerList.sex"}},[e._v("女")])],1),o("el-form-item",{attrs:{label:"电话",prop:"phone"}},[o("el-input",{model:{value:e.readerList.phone,callback:function(t){e.$set(e.readerList,"phone",t)},expression:"readerList.phone"}})],1),o("el-form-item",{attrs:{label:"当前信用等级",prop:"authority"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.readerList.authority,callback:function(t){e.$set(e.readerList,"authority",t)},expression:"readerList.authority"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确定")]),o("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},X=[],Y={mounted:function(){var e=this,t=sessionStorage.getItem("user"),o=JSON.parse(t);this.axios.post("/reader/readerinfo",c.a.stringify({readerId:o.userId})).then(function(t){console.log(t.data),t.data&&(e.readerList=t.data)}).catch(function(t){e.$message.error("".concat(t.message),"ERROR!")})},data:function(){var e=function(e,t,o){""===t||null===t?o(new Error("不能为空")):o()},t=function(e,t,o){var r=/^[0-9]+$/,a=new RegExp(r);null===t||""===t?o(new Error("不能为空")):11!=t.length?o(new Error("必须为11位数字")):a.test(t)?o():o("必须是数字")},o=function(e,t,o){var r=/^[0-9]+$/,a=new RegExp(r);""===t?o(new Error("不能为空")):a.test(t)?parseInt(t)<0||parseInt(t)>150?o(new Error("数字越界")):o():o("必须是数字")};return{readerList:{readerId:"",realName:"",age:"",sex:"",phone:"",authority:""},addRules:{name:[{validator:e,trigger:"blur"}],age:[{validator:o,trigger:"blur"}],sex:[{validator:e,trigger:"blur"}],phone:[{validator:t,trigger:"blur"}],level:[{validator:e,trigger:"blur"}]}}},methods:{onSubmit:function(){var e=this;this.$refs.readerList.validate(function(t){var o={readerId:e.readerList.readerId,realName:e.readerList.realName,age:e.readerList.age,sex:e.readerList.sex,phone:e.readerList.phone};t&&e.axios.post("/reader/updatereader",o).then(function(t){t.data&&(1==t.data?e.$message.success("修改成功"):e.$message.error("修改失败"))}).catch(function(t){e.$message.error("".concat(t.message),"ERROR!")})})},cancel:function(){this.$router.push("/book")}}},Z=Y,ee=(o("3a23"),Object(p["a"])(Z,W,X,!1,null,"4a62f5bb",null)),te=ee.exports,oe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"borrowbook",staticStyle:{margin:"auto"}},[o("b-container",[o("el-row",{attrs:{gutter:20}},[o("h4",[e._v("我的借阅")])]),o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.myborrow.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize),border:"","max-height":"600"}},[o("el-table-column",{attrs:{prop:"bookName",label:"书名",width:"180"}}),o("el-table-column",{attrs:{prop:"borrowDate",label:"借书日期",width:"180"}}),o("el-table-column",{attrs:{prop:"returnDate",label:"归还日期",width:"180"}}),o("el-table-column",{attrs:{prop:"renewCount",label:"续借次数",width:"180"}}),o("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[null==t.row.returnDate?o("el-button-group",[o("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(o){return e.returnBook(t.row)}}},[e._v("还书")]),o("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:function(o){return e.renewBook(t.row)}}},[e._v("续借")])],1):o("el-button-group",[o("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(o){return e.returnBook(t.row)}}},[e._v("删除记录")])],1)]}}])})],1),o("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.myborrow.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},re=[],ae=(o("3e8f"),{inject:["reload"],mounted:function(){this.handlehisttory()},data:function(){return{currentPage:1,pagesize:10,myborrow:[]}},methods:{handleSizeChange:function(e){this.pagesize=e,console.log(this.pagesize)},handleCurrentChange:function(e){this.currentPage=e,console.log(this.currentPage)},handlehisttory:function(){var e=this;if(null!=sessionStorage.getItem("user")){var t=sessionStorage.getItem("user"),o=JSON.parse(t);this.axios.post("borrow/getmyborrow",c.a.stringify({readerId:o.userId})).then(function(t){t.data?(console.log(t.data),e.myborrow=t.data):e.$message.error("未找到结果")}).catch(function(t){e.$message.error("错误","ERROR!")})}},returnBook:function(e){var t=this;this.axios.post("/borrow/returnBook",c.a.stringify({borrowId:e.borrowId,readerId:e.readerId,bookId:e.bookId})).then(function(e){console.log(e.data),0==e.data?(t.$message.success("还书成功"),t.reload()):t.$message.error("还书失败","ERROR!")}).catch(function(e){t.$message.error("".concat(e.message),"ERROR!")})},renewBook:function(e){var t=this;this.axios.post("/borrow/renewBook",c.a.stringify({borrowId:e.borrowId,readerId:e.readerId,bookId:e.bookId})).then(function(e){console.log(e.data),0==e.data?(t.$message.success("续借成功"),t.reload()):t.$message.error("续借次数到达上限","ERROR!")}).catch(function(e){t.$message.error("".concat(e.message),"ERROR!")})}}}),se=ae,ie=(o("75d0"),Object(p["a"])(se,oe,re,!1,null,"34b3a0bb",null)),ne=ie.exports,le=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"bookmanage"},[o("b-container",[o("el-row",{attrs:{gutter:20}},[o("h4",[e._v("我的收藏")])]),o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.bookList.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize),"max-height":"350"},on:{"row-click":e.op}},[o("el-table-column",{attrs:{label:"封面",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return[o("img",{staticClass:"head_pic",attrs:{src:e.row.picture,width:"40",height:"40"}})]}}])}),o("el-table-column",{attrs:{prop:"bookName",label:"书名",width:"200"}}),o("el-table-column",{attrs:{prop:"ISBN",label:"ISBN",width:"200"}}),o("el-table-column",{attrs:{prop:"typeName",label:"类型",width:"200"}}),o("el-table-column",{attrs:{prop:"author",label:"作者",width:"200"}}),o("el-table-column",{attrs:{prop:"publisher",label:"出版社"}})],1),o("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.bookList.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},ce=[],ue={data:function(){return{currentPage:1,pagesize:10,bookList:[],search:"",postBook:{bookId:"",bookName:"",ISBN:"",typeName:"",author:"",publisher:""},condition:""}},created:function(){this.handleBookList()},methods:{op:function(e){this.$router.push({name:"detail",query:{info:e.bookId}})},handleSizeChange:function(e){this.pagesize=e,console.log(this.pagesize)},handleCurrentChange:function(e){this.currentPage=e,console.log(this.currentPage)},handleBookList:function(){var e=this;if(null!=sessionStorage.getItem("user")){var t=sessionStorage.getItem("user"),o=JSON.parse(t);this.axios.post("favor/getfavor",c.a.stringify({readerId:o.userId})).then(function(t){t.data?(console.log(t.data),e.bookList=t.data):e.$message.error("加载失败")}).catch(function(t){e.$message.error("错误","ERROR!")})}}}},de=ue,pe=(o("3b67"),Object(p["a"])(de,le,ce,!1,null,"52c1fc02",null)),me=pe.exports,be=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"addbook"},[o("el-form",{ref:"bookList",attrs:{rules:e.addRules,model:e.bookList,"label-width":"80px",size:"small"}},[o("el-form-item",{attrs:{label:"图书名称",prop:"bookName"}},[o("el-input",{model:{value:e.bookList.bookName,callback:function(t){e.$set(e.bookList,"bookName",t)},expression:"bookList.bookName"}})],1),o("el-form-item",{attrs:{label:"ISBN",prop:"ISBN"}},[o("el-input",{model:{value:e.bookList.ISBN,callback:function(t){e.$set(e.bookList,"ISBN",t)},expression:"bookList.ISBN"}})],1),o("el-form-item",{attrs:{label:"作者",prop:"author"}},[o("el-input",{model:{value:e.bookList.author,callback:function(t){e.$set(e.bookList,"author",t)},expression:"bookList.author"}})],1),o("el-form-item",{attrs:{label:"出版社",prop:"publisher"}},[o("el-input",{model:{value:e.bookList.publisher,callback:function(t){e.$set(e.bookList,"publisher",t)},expression:"bookList.publisher"}})],1),o("el-form-item",{attrs:{label:"类型",prop:"typeName"}},[o("el-select",{model:{value:e.bookList.typeName,callback:function(t){e.$set(e.bookList,"typeName",t)},expression:"bookList.typeName"}},[o("el-option",{attrs:{label:"教育",value:"教育",checked:""}}),o("el-option",{attrs:{label:"科幻",value:"科幻"}}),o("el-option",{attrs:{label:"自然",value:"自然",checked:""}}),o("el-option",{attrs:{label:"文学",value:"文学"}}),o("el-option",{attrs:{label:"政治",value:"政治",checked:""}}),o("el-option",{attrs:{label:"哲学",value:"哲学"}})],1)],1),o("el-form-item",{attrs:{label:"单价",prop:"price"}},[o("el-input",{model:{value:e.bookList.price,callback:function(t){e.$set(e.bookList,"price",t)},expression:"bookList.price"}})],1),o("el-form-item",{attrs:{label:"数量",prop:"total"}},[o("el-input",{model:{value:e.bookList.total,callback:function(t){e.$set(e.bookList,"total",t)},expression:"bookList.total"}})],1),o("el-form-item",{attrs:{label:"简介",prop:"description"}},[o("el-input",{model:{value:e.bookList.description,callback:function(t){e.$set(e.bookList,"description",t)},expression:"bookList.description"}})],1),o("el-form-item",{attrs:{label:"书架",prop:"shelter"}},[o("el-input",{model:{value:e.bookList.shelter,callback:function(t){e.$set(e.bookList,"shelter",t)},expression:"bookList.shelter"}})],1),o("el-form-item",{attrs:{label:"操作",width:"180"}},[[o("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{name:"file",action:"http://localhost:8085/book/postimg/","on-change":e.handleChange,beforeUpload:e.beforeAVatarUpload,limit:e.limit,"on-exceed":e.onExceed,"on-remove":e.handleRemove,onError:e.uploadError,onSuccess:e.uploadSuccess,"auto-upload":!1,data:e.bookList,"file-list":e.fileList}},[o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)]],2),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确定")]),o("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},he=[];function ge(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var fe={data:function(){var e=function(e,t,o){""===t?o(new Error("不能为空")):o()},t=function(e,t,o){var r=/^[0-9]+$/,a=new RegExp(r);""===t?o(new Error("不能为空")):a.test(t)?o():o("必须是整数")},o=function(e,t,o){var r=/^[0-9]+$/,a=new RegExp(r);""===t?o(new Error("不能为空")):13!=t.length?o(new Error("必须为13位数字")):a.test(t)?o():o("必须是数字")};return{fileList:[],limit:1,bookList:{bookName:"",ISBN:"",typeName:"",author:"",publisher:"",price:"",total:"",description:"",shelter:""},addRules:ge({bookName:[{validator:e,trigger:"blur"}],ISBN:[{validator:o,trigger:"blur"}],typeName:[{validator:e,trigger:"blur"}],author:[{validator:e,trigger:"blur"}],publisher:[{validator:e,trigger:"blur"}],price:[{validator:t,trigger:"blur"}],total:[{validator:t,trigger:"blur"}]},"typeName",[{validator:e,trigger:"blur"}])}},methods:{submitUpload:function(){this.$refs.upload.submit()},handleChange:function(e,t){this.fileList=t.slice(-3)},uploadSuccess:function(e,t,o){1==e?this.$message.success("添加成功"):this.$message.error("增加失败")},uploadError:function(e,t,o){this.$message.error("上传图片失败！")},onExceed:function(e,t){this.$message.error("提示：只能上传一张图片！")},onSubmit:function(){var e=this;this.$refs.bookList.validate(function(t){t&&(0!=e.fileList.length?e.submitUpload():e.$message.error("图片为空"))})},cancel:function(){this.$router.push("/book")},beforeAVatarUpload:function(e){if("image/jpg"!==e.type&&"image/jpeg"!==e.type&&"image/png"!==e.type&&"image/gif"!==e.type)return this.$message.error("只支持jpg、png、gif格式的图片！"),!1},handleRemove:function(e,t){this.fileList=[]}}},ve=fe,ke=(o("3923"),Object(p["a"])(ve,be,he,!1,null,"69650c4b",null)),we=ke.exports,ye=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{name:"file",action:"http://localhost:8085/book/postimg/","on-change":e.handleChange,limit:e.limit,"on-exceed":e.onExceed,onError:e.uploadError,onSuccess:e.uploadSuccess,"auto-upload":!1,"file-list":e.fileList}},[o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1),o("el-button",{on:{click:function(t){return e.submitUpload()}}},[e._v(" ss")])],1)},Le=[],$e={data:function(){return{fileList:[],limit:1}},methods:{submitUpload:function(){this.$refs.upload.submit()},handleChange:function(e,t){this.fileList3=t.slice(-3)},uploadSuccess:function(e,t,o){this.fileIds=e.fileIds,console.log("上传图片成功"),console.log(this.fileList)},uploadError:function(e,t,o){this.$message.error("上传图片失败！")},onExceed:function(e,t){this.$message.error("提示：只能上传一张图片！")}}},xe=$e,Se=Object(p["a"])(xe,ye,Le,!1,null,null,null),_e=Se.exports,Re=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"addbook"},[o("el-form",{ref:"bookList",attrs:{rules:e.addRules,model:e.bookList,"label-width":"80px",size:"small"}},[o("el-form-item",{attrs:{label:"图书名称",prop:"bookName"}},[o("el-input",{model:{value:e.bookList.bookName,callback:function(t){e.$set(e.bookList,"bookName",t)},expression:"bookList.bookName"}})],1),o("el-form-item",{attrs:{label:"ISBN",prop:"ISBN"}},[o("el-input",{model:{value:e.bookList.ISBN,callback:function(t){e.$set(e.bookList,"ISBN",t)},expression:"bookList.ISBN"}})],1),o("el-form-item",{attrs:{label:"作者",prop:"author"}},[o("el-input",{model:{value:e.bookList.author,callback:function(t){e.$set(e.bookList,"author",t)},expression:"bookList.author"}})],1),o("el-form-item",{attrs:{label:"出版社",prop:"publisher"}},[o("el-input",{model:{value:e.bookList.publisher,callback:function(t){e.$set(e.bookList,"publisher",t)},expression:"bookList.publisher"}})],1),o("el-form-item",{attrs:{label:"类型",prop:"typeName"}},[o("el-select",{model:{value:e.bookList.typeName,callback:function(t){e.$set(e.bookList,"typeName",t)},expression:"bookList.typeName"}},[o("el-option",{attrs:{label:"教育",value:"教育",checked:""}}),o("el-option",{attrs:{label:"科幻",value:"科幻"}})],1)],1),o("el-form-item",{attrs:{label:"单价",prop:"price"}},[o("el-input",{model:{value:e.bookList.price,callback:function(t){e.$set(e.bookList,"price",t)},expression:"bookList.price"}})],1),o("el-form-item",{attrs:{label:"数量",prop:"total"}},[o("el-input",{model:{value:e.bookList.total,callback:function(t){e.$set(e.bookList,"total",t)},expression:"bookList.total"}})],1),o("el-form-item",{attrs:{label:"简介",prop:"description"}},[o("el-input",{model:{value:e.bookList.description,callback:function(t){e.$set(e.bookList,"description",t)},expression:"bookList.description"}})],1),o("el-form-item",{attrs:{label:"书架",prop:"shelter"}},[o("el-input",{model:{value:e.bookList.shelter,callback:function(t){e.$set(e.bookList,"shelter",t)},expression:"bookList.shelter"}})],1),o("el-form-item",{attrs:{label:"操作",width:"180"}},[[o("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{name:"file",action:"http://localhost:8085/book/updatebookpicture/","on-change":e.handleChange,beforeUpload:e.beforeAVatarUpload,limit:e.limit,"on-exceed":e.onExceed,"on-remove":e.handleRemove,onError:e.uploadError,onSuccess:e.uploadSuccess,"auto-upload":!1,data:e.bookList,"file-list":e.fileList}},[o("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)]],2),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确定")]),o("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},Ne=[];function Ie(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var ze={data:function(){var e=function(e,t,o){""===t?o(new Error("不能为空")):o()},t=function(e,t,o){var r=/^[0-9]+$/,a=new RegExp(r);""===t?o(new Error("不能为空")):a.test(t)?o():o("必须是整数")},o=function(e,t,o){var r=/^[0-9]+$/,a=new RegExp(r);""===t?o(new Error("不能为空")):13!=t.length?o(new Error("必须为13位数字")):a.test(t)?o():o("必须是数字")};return{fileList:[],limit:1,bookList:{bookId:"",bookName:"",ISBN:"",typeName:"",author:"",publisher:"",price:"",total:"",description:"",shelter:""},addRules:Ie({bookName:[{validator:e,trigger:"blur"}],ISBN:[{validator:o,trigger:"blur"}],typeName:[{validator:e,trigger:"blur"}],author:[{validator:e,trigger:"blur"}],publisher:[{validator:e,trigger:"blur"}],price:[{validator:t,trigger:"blur"}],total:[{validator:t,trigger:"blur"}]},"typeName",[{validator:e,trigger:"blur"}])}},created:function(){console.log(this.$route.params.info),this.bookList=this.$route.params.info},methods:{submitUpload:function(){this.$refs.upload.submit()},handleChange:function(e,t){this.fileList=t.slice(-3)},uploadSuccess:function(e,t,o){1==e?this.$message.success("添加成功"):this.$message.error("增加失败")},uploadError:function(e,t,o){this.$message.error("上传图片失败！")},onExceed:function(e,t){this.$message.error("提示：只能上传一张图片！")},onSubmit:function(){var e=this;this.$refs.bookList.validate(function(t){if(t)if(0!=e.fileList.length)e.submitUpload();else{console.log(e.fileList.length);var o={bookId:e.bookList.bookId,bookName:e.bookList.bookName,ISBN:e.bookList.ISBN,typeName:e.bookList.typeName,author:e.bookList.author,publisher:e.bookList.publisher,price:e.bookList.price,total:e.bookList.total,stockNum:e.bookList.total,description:e.bookList.description,shelter:e.bookList.shelter};e.axios.post("/book/updatebook",o).then(function(t){t.data&&(console.log(t.data),t.data?e.$message.success("修改成功"):e.$message.error("修改失败"))}).catch(function(t){e.$message.error("".concat(t.message),"ERROR!")})}})},cancel:function(){this.$router.push("/book")},beforeAVatarUpload:function(e){if("image/jpg"!==e.type&&"image/jpeg"!==e.type&&"image/png"!==e.type&&"image/gif"!==e.type)return this.$message.error("只支持jpg、png、gif格式的图片！"),!1},handleRemove:function(e,t){this.fileList=[]}}},Ee=ze,Ce=(o("edfd"),Object(p["a"])(Ee,Re,Ne,!1,null,"5443c254",null)),Oe=Ce.exports,Pe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"addbook"},[o("el-form",{ref:"user",attrs:{model:e.user,"label-width":"80px",size:"small"}},[o("el-form-item",{attrs:{label:"当前用户"}},[o("el-input",{model:{value:e.user.userName,callback:function(t){e.$set(e.user,"userName",t)},expression:"user.userName"}})],1),o("el-form-item",{attrs:{label:"当前密码"}},[o("el-input",{model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确定")]),o("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},Be=[],je={data:function(){return{bookList:{bookName:"",ISBN:"",typeName:"",author:"",publisher:"",price:"",total:""},user:null}},created:function(){this.handleUser()},methods:{onSubmit:function(){this.$message.success("提交成功")},cancel:function(){},handleUser:function(){console.log(sessionStorage.getItem("user"));var e=sessionStorage.getItem("user");this.user=JSON.parse(e)}}},Ue=je,Ae=(o("a309"),Object(p["a"])(Ue,Pe,Be,!1,null,"0848a942",null)),Me=Ae.exports,Ve=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"borrowbook",staticStyle:{margin:"auto"}},[o("b-container",[o("el-row",{attrs:{gutter:20}},[o("h4",[e._v("借阅管理")])]),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:6}},[o("el-select",{attrs:{clearable:"",placeholder:"请选择搜索类型"},model:{value:e.condition,callback:function(t){e.condition=t},expression:"condition"}},[o("el-option",{attrs:{label:"用户",value:"用户"}}),o("el-option",{attrs:{label:"书名",value:"书名"}})],1)],1),o("el-col",{attrs:{span:6}},[o("el-input",{attrs:{placeholder:"请输入搜索内容","prefix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),o("el-col",{attrs:{span:2}},[o("el-button",{attrs:{type:"primary",round:"",size:"medium"},on:{click:e.applysearch}},[e._v("搜索")])],1),o("el-col",{attrs:{span:2}},[o("el-button",{attrs:{type:"primary",round:"",size:"medium"},on:{click:e.reset}},[e._v("清空搜索")])],1)],1),o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.myborrow.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize),border:"","max-height":"600"}},[o("el-table-column",{attrs:{prop:"userName",label:"用户名",width:"180"}}),o("el-table-column",{attrs:{prop:"bookName",label:"书名",width:"180"}}),o("el-table-column",{attrs:{prop:"borrowDate",label:"借书日期",width:"180"}}),o("el-table-column",{attrs:{prop:"returnDate",label:"归还日期",width:"180"}}),o("el-table-column",{attrs:{prop:"renewCount",label:"续借次数",width:"180"}}),o("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[null==t.row.returnDate?o("el-button-group",[o("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(o){return e.returnBook(t.row)}}},[e._v("还书")]),o("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:function(o){return e.renewBook(t.row)}}},[e._v("续借")])],1):o("el-button-group",[o("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(o){return e.returnBook(t.row)}}},[e._v("删除记录")])],1)]}}])})],1),o("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.myborrow.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},Je=[],qe={inject:["reload"],mounted:function(){this.handlehisttory()},data:function(){return{currentPage:1,pagesize:10,search:"",condition:"",myborrow:[]}},methods:{handleSizeChange:function(e){this.pagesize=e,console.log(this.pagesize)},handleCurrentChange:function(e){this.currentPage=e,console.log(this.currentPage)},handlehisttory:function(){var e=this;this.axios.get("borrow/getallborrow").then(function(t){t.data?(console.log(t.data),e.myborrow=t.data):e.$message.error("未找到结果")}).catch(function(t){e.$message.error("错误","ERROR!")})},returnBook:function(e){var t=this;this.axios.post("/borrow/returnBook",c.a.stringify({borrowId:e.borrowId,readerId:e.readerId,bookId:e.bookId})).then(function(e){console.log(e.data),0==e.data?(t.$message.success("还书成功"),t.reload()):t.$message.error("还书失败","ERROR!")}).catch(function(e){t.$message.error("".concat(e.message),"ERROR!")})},renewBook:function(e){var t=this;this.axios.post("/borrow/renewBook",c.a.stringify({borrowId:e.borrowId,readerId:e.readerId,bookId:e.bookId})).then(function(e){console.log(e.data),0==e.data?(t.$message.success("续借成功"),t.reload()):t.$message.error("续借次数到达上限","ERROR!")}).catch(function(e){t.$message.error("".concat(e.message),"ERROR!")})},applysearch:function(){var e=this;""!=this.search&&""!=this.condition?("用户"==this.condition&&this.axios.post("borrow/selectByUser",c.a.stringify({userName:this.search})).then(function(t){e.bookList=t.data,t.data&&(console.log(t.data),t.data?e.myborrow=t.data:e.$message.error("未找到结果"))}).catch(function(t){e.$message.error("".concat(t.message),"ERROR!")}),"书名"==this.condition&&this.axios.post("borrow/selectByBook",c.a.stringify({bookName:this.search})).then(function(t){e.bookList=t.data,t.data&&(console.log(t.data),t.data?e.myborrow=t.data:e.$message.error("未找到结果"))}).catch(function(t){e.$message.error("".concat(t.message),"ERROR!")})):this.$message.error("搜索条件不能为空")},addbook:function(){this.$router.push("/bookchange")},reset:function(){this.onSearch=!1,this.currentPage=1,this.handlehisttory(),this.search="",this.condition=""}}},De=qe,Te=(o("613f"),Object(p["a"])(De,Ve,Je,!1,null,"5e8dec7c",null)),Fe=Te.exports,Ge=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"readermanage"},[o("b-container",[o("el-row",{attrs:{gutter:20}},[o("h4",[e._v("用户管理")])]),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:6}},[o("el-radio",{attrs:{label:"1"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("用户编号")]),o("el-radio",{attrs:{label:"2"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("用户名")])],1),o("el-col",{attrs:{span:6}},[o("el-input",{attrs:{placeholder:"请输入搜索内容","prefix-icon":"el-icon-search"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),o("el-col",{attrs:{span:100}},[o("el-button",{attrs:{type:"primary",round:"",size:"medium"},on:{click:e.applysearch}},[e._v("搜索")])],1),o("el-col",{attrs:{span:6}},[o("el-button",{attrs:{type:"primary",round:"",size:"medium"},on:{click:e.reset}},[e._v("清空搜索")])],1)],1),o("el-table",{staticStyle:{width:"100%",margin:"auto"},attrs:{data:e.userList.slice((e.currentPage-1)*e.pagesize,e.currentPage*e.pagesize),"max-height":"350"}},[o("el-table-column",{attrs:{prop:"userId",label:"读者编号",width:"80"}}),o("el-table-column",{attrs:{prop:"userName",label:"用户名",width:"180"}}),o("el-table-column",{attrs:{prop:"authority",label:"当前权限",width:"180"}}),o("el-table-column",{attrs:{label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button-group",[o("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(o){return e.modify(t.row,t.$index)}}},[e._v("赋予管理员权限")]),o("el-button",{attrs:{type:"danger",round:"",size:"mini"},on:{click:function(o){return e.dele(t.row,t.$index)}}},[e._v("删除")])],1)]}}])})],1),o("el-pagination",{staticStyle:{width:"60%",margin:"auto"},attrs:{"current-page":e.currentPage,"page-sizes":[5],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.userList.length},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},He=[],Ke={inject:["reload"],data:function(){return{currentPage:1,pagesize:5,userList:[],search:"",radio:"1"}},created:function(){this.handleUserList()},methods:{handleSizeChange:function(e){this.pagesize=e,console.log(this.pagesize)},handleCurrentChange:function(e){this.currentPage=e,console.log(this.currentPage)},handleUserList:function(){var e=this;this.axios.get("user/showuser").then(function(t){return e.userList=t.data})},dele:function(e,t){var o=this;this.$confirm("确认删除？").then(function(t){o.axios.post("user/deleteuser",e).then(function(e){console.log(e),e.data&&(e.data?o.$message.success("删除成功"):o.$message.error("删除失败")),o.reload()}).catch(function(e){o.$message.error("用户无法删除","ERROR!")})}).catch(function(e){})},applysearch:function(){var e=this;if(""!=this.search&&""!=this.radio){var t={userId:"",userName:""};switch(this.radio){case"1":t.userId=this.search;break;case"2":t.userName=this.search;break;default:}this.axios.post("user/usersearch",t).then(function(t){t.data&&(0!=t.data.success?e.userList=t.data:e.$message.error("未找到结果"))}).catch(function(t){e.$message.error("".concat(t.message),"ERROR!")})}else this.$message.error("搜索条件不能为空")},reset:function(){this.handleUserList(),this.search="",this.condition="1"},modify:function(e,t){var o=this;this.$confirm("确认赋予管理员权限？").then(function(t){o.axios.post("user/addadmin",e).then(function(e){e.data&&(e.data.success?o.$message.success("权限赋予成功成功"):o.$message.error("权限赋予失败"))}).catch(function(e){o.$message.error("权限赋予失败","ERROR!")}),o.reload()}).catch(function(e){})}}},Qe=Ke,We=(o("305c"),Object(p["a"])(Qe,Ge,He,!1,null,"bab43b26",null)),Xe=We.exports,Ye=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"addbook"},[o("el-form",{ref:"user",attrs:{model:e.bookList,"label-width":"80px",size:"small"}},[o("el-form-item",{attrs:{label:"添加类型"}},[o("el-input",{model:{value:e.bookList.bookName,callback:function(t){e.$set(e.bookList,"bookName",t)},expression:"bookList.bookName"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确定")]),o("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1),o("el-form",{ref:"user",attrs:{model:e.bookList,"label-width":"80px",size:"small"}},[o("el-form-item",{attrs:{label:"删除类型"}},[o("el-input",{model:{value:e.bookList.typeName,callback:function(t){e.$set(e.bookList,"typeName",t)},expression:"bookList.typeName"}})],1),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确定")]),o("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},Ze=[],et={data:function(){return{bookList:{bookName:"",ISBN:"",typeName:"",author:"",publisher:"",price:"",total:""},user:null}},created:function(){this.handleUser()},methods:{onSubmit:function(){this.$message.success("提交成功")},cancel:function(){},handleUser:function(){console.log(sessionStorage.getItem("user"));var e=sessionStorage.getItem("user");this.user=JSON.parse(e)}}},tt=et,ot=(o("f680"),Object(p["a"])(tt,Ye,Ze,!1,null,"4121e75f",null)),rt=ot.exports;r["default"].use(k["a"]);var at=new k["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:S},{path:"/about",name:"about",component:function(){return o.e("about").then(o.bind(null,"f820"))}},{path:"/login",name:"Login",component:E},{path:"/detail",name:"detail",component:U},{path:"/content",name:"Content",component:D},{path:"/manager",name:"manager",component:Q},{path:"/readerinfo",name:"readerinfo",component:te},{path:"/myborrow",name:"myborrow",component:ne},{path:"/myfavor",name:"myfavor",component:me},{path:"/addbook",name:"addbook",component:we},{path:"/modifybook",name:"modifybook",component:Oe},{path:"/userinfo",name:"userinfo",component:Me},{path:"/test",name:"test",component:_e},{path:"/borrowmanage",name:"borrowmanage",component:Fe},{path:"/readermanage",name:"readermanage",component:Xe},{path:"/typemanage",name:"typemanage",component:rt}]}),st=o("5f5b"),it=(o("f9e3"),o("2dd8"),o("5c96")),nt=o.n(it),lt=(o("0fae"),o("7338")),ct=o.n(lt),ut=o("29a6"),dt=o.n(ut);o("c69f");r["default"].use(nt.a),r["default"].use(st["a"]),r["default"].config.productionTip=!1,r["default"].use(nt.a),r["default"].use(dt.a,ct.a),ct.a.defaults.timeout=5e3,ct.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",ct.a.defaults.baseURL="http://47.103.36.216:8085",ct.a.defaults.withCredentials=!1,new r["default"]({router:at,render:function(e){return e(v)}}).$mount("#app")},"5aa7":function(e,t,o){},"613f":function(e,t,o){"use strict";var r=o("0527"),a=o.n(r);a.a},"64a9":function(e,t,o){},6508:function(e,t,o){},"73ba":function(e,t,o){"use strict";var r=o("2cde"),a=o.n(r);a.a},"75d0":function(e,t,o){"use strict";var r=o("9ab3"),a=o.n(r);a.a},"7f67":function(e,t,o){},"92e6":function(e,t,o){"use strict";var r=o("3fc3"),a=o.n(r);a.a},9589:function(e,t,o){"use strict";var r=o("6508"),a=o.n(r);a.a},"9ab3":function(e,t,o){},a309:function(e,t,o){"use strict";var r=o("7f67"),a=o.n(r);a.a},ba6d:function(e,t,o){},c69f:function(e,t,o){},edfd:function(e,t,o){"use strict";var r=o("4b6c"),a=o.n(r);a.a},f680:function(e,t,o){"use strict";var r=o("54f8"),a=o.n(r);a.a},ff0f:function(e,t,o){"use strict";var r=o("1a8b"),a=o.n(r);a.a}});
//# sourceMappingURL=app.8fd0fecf.js.map